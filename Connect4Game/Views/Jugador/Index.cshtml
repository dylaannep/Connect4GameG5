@model JugadorViewModel
@{
    ViewData["Title"] = "Lista de Jugadores";
}

<!-- jQuery y DataTables -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

<!-- CSS de DataTables -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">



<div class="container mt-4">
    <div class="row align-items-center mb-5">
        <div class="col">
            <h2 class="mb-0">Jugadores</h2>
        </div>
        <div class="col-md-2 col-sm-4 col-6 text-end">
            <button class="btn btn-game btn-primary w-100" role="button" data-bs-toggle="modal"
                data-bs-target="#modalCrearJugador">
                <span class="text">AÃ±adir ðŸ‘¥</span>
            </button>
        </div>
    </div>

    <!-- Tabla de jugadores -->
    <div class="row">
        <div class="col-12">
            <table id="tablaJugadores" class="table table-striped table-bordered table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>IdentificaciÃ³n</th>
                        <th>Nombre</th>
                        <th>Marcador</th>
                        <th>|</th>
                        <th>Ganadas</th>
                        <th>Perdidas</th>
                        <th>Empatadas</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var jugador in Model.Jugadores)
                    {
                        <tr class="text-light">
                            <td>@jugador.Identificacion</td>
                            <td>@jugador.Nombre</td>
                            <td>@jugador.Marcador</td>
                            <td>|</td>
                            <td>@jugador.Victorias</td>
                            <td>@jugador.Derrotas</td>
                            <td>@jugador.Empates</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>


@await Html.PartialAsync("_CreatePlayerModal", Model.NuevoJugador)


<script>
    document.addEventListener("DOMContentLoaded", function () {
        const urlParams = new URLSearchParams(window.location.search);
        const abrirModal = urlParams.get('modal');
        if (abrirModal === 'true') {
            const modal = new bootstrap.Modal(document.getElementById('modalCrearJugador'));
            modal.show();
        }
    });
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var mostrar = @((ViewBag.MostrarModal != null && (bool)ViewBag.MostrarModal) ? "true" : "false");
        if (mostrar) {
            var modal = new bootstrap.Modal(document.getElementById('modalCrearJugador'));
            modal.show();
        }
    });
</script>


<script>
    $('#tablaJugadores').DataTable({
        order: [[2, 'desc']],
        language: {
            url: "//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"
        }
    });
</script>

@* 
<script>
document.addEventListener("DOMContentLoaded", function() {
    // 1 Verificar ViewBag
    var mostrar = @((ViewBag.MostrarModal != null && (bool)ViewBag.MostrarModal) ? "true" : "false");

    // 2 Si ViewBag no indica abrir modal, revisar query string
    if (mostrar !== "true") {
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('modal') === 'true') {
            mostrar = "true";
        }
    }

    // 3 Mostrar el modal si corresponde
    if (mostrar === "true") {
        const modal = new bootstrap.Modal(document.getElementById('modalCrearJugador'));
        modal.show();
    }
});
</script> *@
